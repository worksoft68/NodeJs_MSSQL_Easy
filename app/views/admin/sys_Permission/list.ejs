<%- include ('./../helpers/pagination') %>
	<% const collection="sys_Permission" ; const linkPrefix=systemConfig.prefixAdmin + `/${collection}/`; %>
		<%- include ('./../elements/notify') %>
			<div class="container-fluid">
				<input name="linkPrefix" id="linkPrefix" type="hidden" value="<%= linkPrefix %>">
				<input name="params" id="params" type="hidden" value="<%= params %>">
				<div class="card card-info card-outline">
					<div class="card-header">
						<h6 class="card-title">Form</h6>
						<div class="card-tools">
							<button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip"
								title="Collapse">
								<i class="fas fa-minus"></i>
							</button>
						</div>
					</div>
					<div class="card-body" style="display: block;">
						<form autocomplete="off" action=" <%= linkPrefix %>searchGet" method="GET">
							<div class="form-group row">
								<label id="labPermissionId"
									class="col-sm-2 col-form-label text-sm-right ">PermissionId</label>
								<div class="col-xs-2 col-sm-2">
									<input type="number" readonly name="PermissionId" id="PermissionId"
										value="<%= item.PermissionId %>" class="form-control form-control-sm">
								</div>
								<label id="labUserId"
									class="col-sm-2 col-form-label text-sm-right required">User</label>
								<div class="col-xs-2 col-sm-2">
									<div class="dropdown">
										<div id="divDropdownFullName" class="dropdown-content">
											<input type="text" id="FullName" name="FullName"
												onkeyup="filterSelectBox('FullName')"
												onfocus="focusDropdown('FullName')" onblur="blurDropdown('FullName')"
												class="form-control form-control-sm">
											<input id="UserId" name="UserId" type="hidden">
											<div id="DivContenFullName" class="Divdropdown-content">
											</div>
										</div>
									</div>
								</div>
								<label id="labFunctions"
									class="col-sm-2 col-form-label text-sm-right required">Function</label>
								<div class="col-xs-2 col-sm-2">
									<div class="dropdown">
										<div id="divDropdownDescription" class="dropdown-content">
											<input type="text" size="75" id="Description" name="Description"
												onkeyup="filterSelectBox('Description')"
												onfocus="focusDropdown('Description')"
												onblur="blurDropdown('Description')"
												class="form-control form-control-sm">
											<input id="Functions" name="Functions" type="hidden">
											<div id="DivContenDescription" class="Divdropdown-content">
											</div>
										</div>
									</div>
								</div>
								<label id="labFullAuthority"
									class="col-sm-2 col-form-label text-sm-right">FullAuthority</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="FullAuthority" id="FullAuthority"
										class="form-control form-control-sm">
								</div>
								<label id="labAddnew" class="col-sm-2 col-form-label text-sm-right ">Addnew</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="Addnew" id="Addnew"
										class="form-control form-control-sm">
								</div>
								<label id="labUpdates" class="col-sm-2 col-form-label text-sm-right ">Updates</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="Updates" id="Updates"
										class="form-control form-control-sm">
								</div>
								<label id="labReadOnly" class="col-sm-2 col-form-label text-sm-right ">ReadOnly</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="ReadOnly" id="ReadOnly"
										class="form-control form-control-sm">
								</div>
								<label id="labFullOfYourself"
									class="col-sm-2 col-form-label text-sm-right ">FullOfYourself</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="FullOfYourself" id="FullOfYourself"
										class="form-control form-control-sm">
								</div>
								<label id="labPermission1"
									class="col-sm-2 col-form-label text-sm-right ">Permission1</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="Permission1" id="Permission1"
										class="form-control form-control-sm">
								</div>
								<label id="labPermission2"
									class="col-sm-2 col-form-label text-sm-right ">Permission2</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="Permission2" id="Permission2"
										class="form-control form-control-sm">
								</div>
								<label id="labPermission3"
									class="col-sm-2 col-form-label text-sm-right ">Permission3</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="Permission3" id="Permission3"
										class="form-control form-control-sm">
								</div>
								<label id="labPermission4"
									class="col-sm-2 col-form-label text-sm-right ">Permission4</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="Permission4" id="Permission4"
										class="form-control form-control-sm">
								</div>
								<label id="labPermission5"
									class="col-sm-2 col-form-label text-sm-right ">Permission5</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="Permission5" id="Permission5"
										class="form-control form-control-sm">
								</div>
								<label id="labPermission6"
									class="col-sm-2 col-form-label text-sm-right ">Permission6</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="Permission6" id="Permission6"
										class="form-control form-control-sm">
								</div>
								<label id="labPermission7"
									class="col-sm-2 col-form-label text-sm-right ">Permission7</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="Permission7" id="Permission7"
										class="form-control form-control-sm">
								</div>
								<label id="labPermission8"
									class="col-sm-2 col-form-label text-sm-right ">Permission8</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="Permission8" id="Permission8"
										class="form-control form-control-sm">
								</div>
								<label id="labPermission9"
									class="col-sm-2 col-form-label text-sm-right ">Permission9</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="Permission9" id="Permission9"
										class="form-control form-control-sm">
								</div>
								<label id="labPermission10"
									class="col-sm-2 col-form-label text-sm-right ">Permission10</label>
								<div class="col-xs-2 col-sm-2">
									<input type="checkbox" name="Permission10" id="Permission10"
										class="form-control form-control-sm">
								</div>


								<label id="labUserIdLike" class="col-sm-2 col-form-label text-sm-right">Rights
									Like
									User</label>
								<div class="col-xs-2 col-sm-2">
									<div class="dropdown">
										<div id="divDropdownFullNameLike" class="dropdown-content">
											<input type="text" id="FullNameLike" name="FullNameLike"
												onkeyup="filterSelectBox('FullNameLike')"
												onfocus="focusDropdown('FullNameLike')"
												onblur="blurDropdown('FullNameLike')"
												class="form-control form-control-sm">
											<input id="UserIdLike" name="UserIdLike" type="hidden">
											<div id="DivContenFullNameLike" class="Divdropdown-content">
											</div>
										</div>
									</div>
								</div>


							</div>
							<div class="form-group row">
								<div class="col-xs-2 col-sm-2"></div>
								<div class="col-xs-10 col-sm-10">
									<input type="button" id="btnSave" class="btn-sm btn-success" value="Save">
									&nbsp; <input type="button" id="btnSaveAs" class="btn-sm btn-danger"
										value="Save as">
									&nbsp; <input type="button" id="btnRightsLikeUser" class="btn-sm btn-warning"
										value="Rights Like User">
									&nbsp; <input type="button" id="btnUpdate" class="btn-sm btn-primary"
										value="Update">
									&nbsp; <input type="button" id="btnDelete" class="btn-sm btn-danger" value="Delete">
									&nbsp; <input type="button" id="btnSearchPost" class="btn-sm btn-info"
										value="Search">
									&nbsp; <input type="submit" id="btnSearchGet" class="btn-sm btn-warning"
										value="Search Get">
									&nbsp; <input type="button" id="btnExport" class="btn-sm btn-success"
										value="Export">
								</div>
							</div>
							<div class="form-group row">
								<div class="text-success" id="divMessage"></div>
							</div>
						</form>
						<input name="PermissionIdHidden" id="PermissionIdHidden" type="hidden">
						<input name="listData" id="listData" type="hidden" value="<%= itemString %>">
						<input name="sysLanguage" id="sysLanguage" type="hidden" value="<%= language %>">
						<input name="listDataCatalogue" id="listDataCatalogue" type="hidden" value="<%= catalogue %>">
					</div>
				</div>
				<div class="card card-info card-outline">
					<div class="card-header">
						<h4 class="card-title">List data</h4>
						<div class="card-tools">
							<button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip"
								title="Collapse"><i class="fas fa-minus"></i></button>
						</div>
					</div>
					<div class="card-body">
						<table id="tableSys_Permission" class="table table-bordered table-hover btn-table mb-0">
							<thead>
								<tr>
									<th class="text-center">
										<div class="custom-control custom-checkbox">
											<input class="custom-control-input cbAll" type="checkbox" id="check-all">
											<label for="check-all" class="custom-control-label"></label>
										</div>
									</th>
									<th class="text-center"><label id="labPermissionId_tb">PermissionId</label></a></th>
									<th class="text-center"><label id="labUserId_tb">UserId</label></a></th>
									<th class="text-center"><label id="labFunctions_tb">Functions</label></a></th>
									<th class="text-center"><label id="labFullAuthority_tb">FullAuthority</label></a>
									</th>
									<th class="text-center"><label id="labAddnew_tb">Addnew</label></a></th>
									<th class="text-center"><label id="labUpdates_tb">Updates</label></a></th>
									<th class="text-center"><label id="labReadOnly_tb">ReadOnly</label></a></th>
									<th class="text-center"><label id="labFullOfYourself_tb">FullOfYourself</label></a>
									</th>
									<th class="text-center"><label id="labPermission1_tb">Permission1</label></a></th>
									<th class="text-center"><label id="labPermission2_tb">Permission2</label></a></th>
									<th class="text-center"><label id="labPermission3_tb">Permission3</label></a></th>
									<th class="text-center"><label id="labPermission4_tb">Permission4</label></a></th>
									<th class="text-center"><label id="labPermission5_tb">Permission5</label></a></th>
									<th class="text-center"><label id="labPermission6_tb">Permission6</label></a></th>
									<th class="text-center"><label id="labPermission7_tb">Permission7</label></a></th>
									<th class="text-center"><label id="labPermission8_tb">Permission8</label></a></th>
									<th class="text-center"><label id="labPermission9_tb">Permission9</label></a></th>
									<th class="text-center"><label id="labPermission10_tb">Permission10</label></a></th>

								</tr>
							</thead>
							<tbody>
								<tr>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>
									<th class="text-center"></a></th>

								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<div class="form-group row">
					<div class="col-xs-1 col-sm-1">Quantity per page:</div>
					<div class="col-xs-1 col-sm-1">
						<input type="number" class="form-control form-control-sm" name="numberItemPerPage"
							id="numberItemPerPage" size="4">
					</div>
					<div class="col-xs-9 col-sm-9" id="paginationSys_Permission">
					</div>
				</div>
			</div>
			<script type="application/javascript">
				var language={};

				onLoadData();
				function onLoadData() {
					getLanguage();
					setUpdateButtonStatus(false)
					setInterfaceText();
					getNumberItemPerPage();
					var strData=$('#listData').val();
					const arrData=JSON.parse(strData);
					if(arrData.length>0) {
						displayDataToTable(arrData);
						var paramsString=$('#params').val();
						const params=JSON.parse(paramsString);
						var linkPrefix=$('#linkPrefix').val();
						paginationHelper(params.pagination,"Sys_Permission",params.currentStatus,params.keyword,linkPrefix,"paginationSys_Permission");
					}
				}

				function displayDataToTable(datas) {
					var table=document.getElementById("tableSys_Permission");
					var lengthtable=table.rows.length-1;
					for(var n=lengthtable;n>0;n--) {
						table.deleteRow(n);
					}
					var length=datas.length;
					if(length<1) {
						showNoticeDanger(language.Message_NotFoundData);
						return false;
					}
					datas.forEach(function(data) {
						var row=table.insertRow(1);
						var cell0=row.insertCell(0);
						var cell1=row.insertCell(1);
						var cell2=row.insertCell(2);
						var cell3=row.insertCell(3);
						var cell4=row.insertCell(4);
						var cell5=row.insertCell(5);
						var cell6=row.insertCell(6);
						var cell7=row.insertCell(7);
						var cell8=row.insertCell(8);
						var cell9=row.insertCell(9);
						var cell10=row.insertCell(10);
						var cell11=row.insertCell(11);
						var cell12=row.insertCell(12);
						var cell13=row.insertCell(13);
						var cell14=row.insertCell(14);
						var cell15=row.insertCell(15);
						var cell16=row.insertCell(16);
						var cell17=row.insertCell(17);
						var cell18=row.insertCell(18);
						//var cell19 = row.insertCell(19);
						let check=`<div class="custom-control custom-checkbox"> 
				<input class="custom-control-input" type="checkbox" name="chkListData" id="${data.PermissionId}" value="${data.PermissionId}">
				<label for="${data.PermissionId}" class="custom-control-label"></label>
			</div>`;

						let strbutton=" <br /> <a  onclick=\"getById('"+data.PermissionId+"')\" type=\"button\" class=\"rounded-circle btn btn-sm btn-info\" title=\"Edit\">"+
							"<i class=\"fas fa-pencil-alt\"></i>"+
							"</a> "+
							" <button type=\"button\" class=\"rounded-circle btn btn-sm btn-danger\" data-id=\""+data.PermissionId+"\" title=\"Delete\"  onclick=\"deleteById(this,"+data.PermissionId+")\">";
						strbutton+=" <i class=\"fas fa-trash-alt\"></i> ";
						strbutton+=" </ button > ";

						cell0.innerHTML=check;
						cell1.innerHTML=data.PermissionId+strbutton;


						cell2.innerHTML=data.FullName;
						cell3.innerHTML=data.Description;
						cell4.innerHTML=data.FullAuthority;
						cell5.innerHTML=data.Addnew;
						cell6.innerHTML=data.Updates;
						cell7.innerHTML=data.ReadOnly;
						cell8.innerHTML=data.FullOfYourself;
						cell9.innerHTML=data.Permission1;
						cell10.innerHTML=data.Permission2;
						cell11.innerHTML=data.Permission3;
						cell12.innerHTML=data.Permission4;
						cell13.innerHTML=data.Permission5;
						cell14.innerHTML=data.Permission6;
						cell15.innerHTML=data.Permission7;
						cell16.innerHTML=data.Permission8;
						cell17.innerHTML=data.Permission9;
						cell18.innerHTML=data.Permission10;

						//cell19.innerHTML = strbutton;
					});
				}

				$("#numberItemPerPage").change(function() {
					setNumberItemPerPage();
				});

				function setUpdateButtonStatus(statusUpdate) {
					$('#btnSave').prop('hidden',statusUpdate);
					$('#btnUpdate').prop('hidden',!statusUpdate);
				}

				function getLanguage() {
					var languageString=$('#sysLanguage').val();
					language=JSON.parse(languageString);
				}

				function setInterfaceText() {
					$("#pageTitle").html(language.TitlePage);
					$("#labPermissionId").text(language.PermissionId);
					$("#labUserId").text(language.UserId);
					$("#labUserIdLike").text(language.UserIdLike);
					$("#labFunctions").text(language.Functions);
					$("#labFullAuthority").text(language.FullAuthority);
					$("#labAddnew").text(language.Addnew);
					$("#labUpdates").text(language.Updates);
					$("#labReadOnly").text(language.ReadOnly);
					$("#labFullOfYourself").text(language.FullOfYourself);
					$("#labPermission1").text(language.Permission1);
					$("#labPermission2").text(language.Permission2);
					$("#labPermission3").text(language.Permission3);
					$("#labPermission4").text(language.Permission4);
					$("#labPermission5").text(language.Permission5);
					$("#labPermission6").text(language.Permission6);
					$("#labPermission7").text(language.Permission7);
					$("#labPermission8").text(language.Permission8);
					$("#labPermission9").text(language.Permission9);
					$("#labPermission10").text(language.Permission10);
					$("#labPermissionId_tb").text(language.PermissionId);
					$("#labUserId_tb").text(language.UserId);
					$("#labFunctions_tb").text(language.Functions);
					$("#labFullAuthority_tb").text(language.FullAuthority);
					$("#labAddnew_tb").text(language.Addnew);
					$("#labUpdates_tb").text(language.Updates);
					$("#labReadOnly_tb").text(language.ReadOnly);
					$("#labFullOfYourself_tb").text(language.FullOfYourself);
					$("#labPermission1_tb").text(language.Permission1);
					$("#labPermission2_tb").text(language.Permission2);
					$("#labPermission3_tb").text(language.Permission3);
					$("#labPermission4_tb").text(language.Permission4);
					$("#labPermission5_tb").text(language.Permission5);
					$("#labPermission6_tb").text(language.Permission6);
					$("#labPermission7_tb").text(language.Permission7);
					$("#labPermission8_tb").text(language.Permission8);
					$("#labPermission9_tb").text(language.Permission9);
					$("#labPermission10_tb").text(language.Permission10);
				}

				createDataForDropdownLists();
				function createDataForDropdownLists() {
					var strCatalogue=$('#listDataCatalogue').val();
					arrCatalogue=JSON.parse(strCatalogue);
					createDataForDropdown(arrCatalogue[0],'Functions','FunctionName','Description','Description','-- Chose --');
					createDataForDropdown(arrCatalogue[1],'UserId','UsersId','FullName','FullName','-- Chose --');
					createDataForDropdown(arrCatalogue[1],'UserIdLike','UsersId','FullNameLike','FullName','-- Chose --');

				}

				closeAllDropdown();
				function closeAllDropdown() {
					var DivContenFullName=document.getElementById('DivContenFullName');
					DivContenFullName.hidden=true;

					var DivContenFullNameLike=document.getElementById('DivContenFullNameLike');
					DivContenFullNameLike.hidden=true;

					var DivContenDescription=document.getElementById('DivContenDescription');
					DivContenDescription.hidden=true;

				}

				function getById(Id) {
					var link=$('#linkPrefix').val()+'getById/'+Id;
					$.ajax({
						type: 'GET',
						url: link,
						dataType: "json",
						success: function(resultdata) {
							var success=resultdata.success;
							if(success==true) {
								showDataToForm(resultdata.data);
							}
						},
						failure: function(response) {
							alert(language.Message_GetItemByIdError);
						},
						error: function(response) {
							alert(language.Message_GetItemByIdError);
						},
					});
				}

				function showDataToForm(data) {
					try {
						setUpdateButtonStatus(true);
						$('#PermissionIdHidden').val(data.PermissionId);
						$('#PermissionId').val(data.PermissionId);
						$('#UserId').val(data.UserId);
						$('#FullName').val(data.FullName);
						$('#Functions').val(data.Functions);
						$('#Description').val(data.Description);
						if((data.FullAuthority=="true")||(data.FullAuthority==true)||(data.FullAuthority=="active")||(data.FullAuthority=="yes")||(data.FullAuthority=="1"))
							$("#FullAuthority").prop("checked",true);
						else $("#FullAuthority").prop("checked",false);
						if((data.Addnew=="true")||(data.Addnew==true)||(data.Addnew=="active")||(data.Addnew=="yes")||(data.Addnew=="1"))
							$("#Addnew").prop("checked",true);
						else $("#Addnew").prop("checked",false);
						if((data.Updates=="true")||(data.Updates==true)||(data.Updates=="active")||(data.Updates=="yes")||(data.Updates=="1"))
							$("#Updates").prop("checked",true);
						else $("#Updates").prop("checked",false);
						if((data.ReadOnly=="true")||(data.ReadOnly==true)||(data.ReadOnly=="active")||(data.ReadOnly=="yes")||(data.ReadOnly=="1"))
							$("#ReadOnly").prop("checked",true);
						else $("#ReadOnly").prop("checked",false);
						if((data.FullOfYourself=="true")||(data.FullOfYourself==true)||(data.FullOfYourself=="active")||(data.FullOfYourself=="yes")||(data.FullOfYourself=="1"))
							$("#FullOfYourself").prop("checked",true);
						else $("#FullOfYourself").prop("checked",false);
						if((data.Permission1=="true")||(data.Permission1==true)||(data.Permission1=="active")||(data.Permission1=="yes")||(data.Permission1=="1"))
							$("#Permission1").prop("checked",true);
						else $("#Permission1").prop("checked",false);
						if((data.Permission2=="true")||(data.Permission2==true)||(data.Permission2=="active")||(data.Permission2=="yes")||(data.Permission2=="1"))
							$("#Permission2").prop("checked",true);
						else $("#Permission2").prop("checked",false);
						if((data.Permission3=="true")||(data.Permission3==true)||(data.Permission3=="active")||(data.Permission3=="yes")||(data.Permission3=="1"))
							$("#Permission3").prop("checked",true);
						else $("#Permission3").prop("checked",false);
						if((data.Permission4=="true")||(data.Permission4==true)||(data.Permission4=="active")||(data.Permission4=="yes")||(data.Permission4=="1"))
							$("#Permission4").prop("checked",true);
						else $("#Permission4").prop("checked",false);
						if((data.Permission5=="true")||(data.Permission5==true)||(data.Permission5=="active")||(data.Permission5=="yes")||(data.Permission5=="1"))
							$("#Permission5").prop("checked",true);
						else $("#Permission5").prop("checked",false);
						if((data.Permission6=="true")||(data.Permission6==true)||(data.Permission6=="active")||(data.Permission6=="yes")||(data.Permission6=="1"))
							$("#Permission6").prop("checked",true);
						else $("#Permission6").prop("checked",false);
						if((data.Permission7=="true")||(data.Permission7==true)||(data.Permission7=="active")||(data.Permission7=="yes")||(data.Permission7=="1"))
							$("#Permission7").prop("checked",true);
						else $("#Permission7").prop("checked",false);
						if((data.Permission8=="true")||(data.Permission8==true)||(data.Permission8=="active")||(data.Permission8=="yes")||(data.Permission8=="1"))
							$("#Permission8").prop("checked",true);
						else $("#Permission8").prop("checked",false);
						if((data.Permission9=="true")||(data.Permission9==true)||(data.Permission9=="active")||(data.Permission9=="yes")||(data.Permission9=="1"))
							$("#Permission9").prop("checked",true);
						else $("#Permission9").prop("checked",false);
						if((data.Permission10=="true")||(data.Permission10==true)||(data.Permission10=="active")||(data.Permission10=="yes")||(data.Permission10=="1"))
							$("#Permission10").prop("checked",true);
						else $("#Permission10").prop("checked",false);
					}
					catch(error) {}
				}

				function clearForm() {
					try {
						$('#PermissionIdHidden').val('');
						setUpdateButtonStatus(false)
						$('#PermissionId').val('');
						$('#UserId').val('');
						$('#FullName').val('');
						$('#Functions').val('');
						$('#Description').val('');
						$("#FullAuthority").prop("checked",false);
						$("#Addnew").prop("checked",false);
						$("#Updates").prop("checked",false);
						$("#ReadOnly").prop("checked",false);
						$("#FullOfYourself").prop("checked",false);
						$("#Permission1").prop("checked",false);
						$("#Permission2").prop("checked",false);
						$("#Permission3").prop("checked",false);
						$("#Permission4").prop("checked",false);
						$("#Permission5").prop("checked",false);
						$("#Permission6").prop("checked",false);
						$("#Permission7").prop("checked",false);
						$("#Permission8").prop("checked",false);
						$("#Permission9").prop("checked",false);
						$("#Permission10").prop("checked",false);
					}
					catch(error) {}
				}

				$('#btnSearchPost').click(function() {
					$(this).prop('disabled',true);
					getContentPages(1);
				});

				function getContentPages(page) {
					var sortStorage=getSortType(linkPrefix);
					var UserId=parseInt($('#UserId').val());
					if(isNaN(UserId)) {
						UserId=0;
					}

					let data={
						'Page': page,
						'UserId': UserId,
						'Functions': $('#Functions').val(),
						numberItemPerPage: $('#numberItemPerPage').val()
					}
					var link=$('#linkPrefix').val()+'search';
					$.ajax({
						type: 'POST',
						url: link,
						data: data,
						dataType: "json",
						success: function(resultdata) {
							$('#btnSearchPost').prop('disabled',false);
							let result=resultdata.result;
							displayDataToTable(result);
							var linkPrefix=$('#linkPrefix').val();
							let params=resultdata.params;
							paginationHelper(params.pagination,"Sys_Permission","","",linkPrefix,"paginationSys_Permission");

							if(params.pagination.totalItems>0) {
								var message=language.Message_Find+params.pagination.totalItems+language.Message_Words_records;
								showNoticeSuccess(message);
							}
						},
						failure: function(response) {
							$('#btnSearchPost').prop('disabled',false);
							showNoticeDanger('Search Error');
						},
						error: function(response) {
							$('#btnSearchPost').prop('disabled',false);
							showNoticeDanger('Search Error');
						}
					});
					$('#btnSearchPost').prop('disabled',false);
				}

				$('#btnSave').click(function() {
					$(this).prop('disabled',true);
					saveInsert();
				});

				$('#btnSaveAs').click(function() {
					$(this).prop('disabled',true);
					$('#PermissionIdHidden').val('');
					$('#PermissionId').val('');
					saveInsert();
				});
				$('#btnRightsLikeUser').click(function() {
					$(this).prop('disabled',true);
					RightsLikeUser();
					$(this).prop('disabled',false);
				});

				function RightsLikeUser() {
					var UserId=parseInt($('#UserId').val());
					if(isNaN(UserId)) {
						var message=formatMessage(language.UserId+": "+language.Message_Invalid_UserId,'0','2147483647');
						alert(message);
						return false;
					}
					var UserIdLike=parseInt($('#UserIdLike').val());
					if(isNaN(UserIdLike)) {
						var message=formatMessage(language.UserIdLike+": "+language.Message_Invalid_UserIdLike,'0','2147483647');
						alert(message);
						return false;
					}

					let messageConfirm=language.Message_RightsLikeUser1+$('#FullName').val()+language.Message_RightsLikeUser2+$('#FullNameLike').val()+'?';
					var answer=confirm(messageConfirm)
					if(!answer) {return false;}



					let data={
						'UserId': UserId,
						'UserIdLike': UserIdLike,
					}
					var link=$('#linkPrefix').val()+'RightsLikeUser';
					$.ajax({
						type: 'post',
						url: link,
						data: data,
						dataType: "json",
						success: function(resultdata) {
							var result=resultdata.result;
							var success=result.success;
							var message=result.message;
							if((success=='true')||(success==true)) {
								let addSuccess=result.addSuccess;
								let addError=result.addError;
								if(addSuccess.length>0) {
									let message=language.Message_AddNewSuccess;
									message+=" "+addSuccess.toString();
									if(addError.length>0) {
										message+=" \n"+language.Message_AddNewError+" "+addError.toString();
									}
									showNoticeSuccess(message);
									return true;
								}
								else if(addError.length>0) {
									let message=language.Message_AddNewError+" "+addError.toString();
									showNoticeDanger(message);
								}
								else {
									showNoticeDanger(language.Message_AddNewError);
								}
							}
							else if((success=='false')||(success==false)) {
								showNoticeDanger(language.Message_AddNewError);
								return false;
							}
						},
						// success: function (resultdata) {
						// 	$('#btnRightsLikeUser').prop('disabled', false);
						// 	let result = resultdata.result;
						// 	showNoticeSuccess(language.Message_AddNewSuccess);

						// },
						failure: function(response) {
							$('#btnRightsLikeUser').prop('disabled',false);
							showNoticeDanger(language.Message_AddNewError);
						},
						error: function(response) {
							$('#btnRightsLikeUser').prop('disabled',false);
							showNoticeDanger(language.Message_AddNewError);
						}
					});
					$('#btnRightsLikeUser').prop('disabled',false);
				}

				function getDataForm() {
					if(($('#UserId').val()<0)||($('#UserId').val()>2147483647)) {
						var message=formatMessage(language.UserId+": "+language.Message_Invalid_UserId,'0','2147483647');
						alert(message);
						return false;
					}
					if(($('#Functions').val().length<1)||($('#Functions').val().length>50)) {
						var message=formatMessage(language.Functions+": "+language.Message_Invalid_Functions,'1','50');
						alert(message);
						return false;
					}
					return {
						'PermissionIdHidden': $('#PermissionIdHidden').val(),
						'PermissionId': $('#PermissionId').val(),
						'UserId': $('#UserId').val(),
						'Functions': $('#Functions').val(),
						'FullAuthority': $('#FullAuthority').is(":checked"),
						'Addnew': $('#Addnew').is(":checked"),
						'Updates': $('#Updates').is(":checked"),
						'ReadOnly': $('#ReadOnly').is(":checked"),
						'FullOfYourself': $('#FullOfYourself').is(":checked"),
						'Permission1': $('#Permission1').is(":checked"),
						'Permission2': $('#Permission2').is(":checked"),
						'Permission3': $('#Permission3').is(":checked"),
						'Permission4': $('#Permission4').is(":checked"),
						'Permission5': $('#Permission5').is(":checked"),
						'Permission6': $('#Permission6').is(":checked"),
						'Permission7': $('#Permission7').is(":checked"),
						'Permission8': $('#Permission8').is(":checked"),
						'Permission9': $('#Permission9').is(":checked"),
						'Permission10': $('#Permission10').is(":checked"),
					}
				}

				function saveInsert() {
					let data=getDataForm();
					if(data==false) {
						$('#btnSave').prop('disabled',false);
						return false;
					}
					var link=$('#linkPrefix').val()+'save';
					$.ajax({
						type: 'post',
						url: link,
						data: data,
						dataType: "json",
						success: function(response) {
							var success=response.success;
							var result=response.data;
							if((success=='false')||(success==false))
								showNoticeDanger(language.Message_AddNewError);
							else if((success!=true)&&(success!='true'))
								showNoticeDanger(result.message);
							else {
								insertRow(result.data);
								//clearForm();
							}
						},
						failure: function(response) {
							showErrorMessageSave(response,language.Message_AddNewError);
						},
						error: function(response) {
							showErrorMessageSave(response,language.Message_AddNewError);
						},
					});
					$('#btnSave').prop('disabled',false);
				}

				function insertRow(data) {
					showNoticeSuccess(language.Message_AddNewSuccess);
					var table=document.getElementById("tableSys_Permission");
					var row=table.insertRow(1);
					var cell0=row.insertCell(0);
					var cell1=row.insertCell(1);
					var cell2=row.insertCell(2);
					var cell3=row.insertCell(3);
					var cell4=row.insertCell(4);
					var cell5=row.insertCell(5);
					var cell6=row.insertCell(6);
					var cell7=row.insertCell(7);
					var cell8=row.insertCell(8);
					var cell9=row.insertCell(9);
					var cell10=row.insertCell(10);
					var cell11=row.insertCell(11);
					var cell12=row.insertCell(12);
					var cell13=row.insertCell(13);
					var cell14=row.insertCell(14);
					var cell15=row.insertCell(15);
					var cell16=row.insertCell(16);
					var cell17=row.insertCell(17);
					var cell18=row.insertCell(18);
					//var cell19 = row.insertCell(19);
					let check=`<div class="custom-control custom-checkbox"> 
					<input class="custom-control-input" type="checkbox" name="chkListData" id="${data.PermissionId}" value="${data.PermissionId}">
					<label for="${data.PermissionId}" class="custom-control-label"></label>
				</div>`;

					let strbutton=" <br /> <a  onclick=\"getById('"+data.PermissionId+"')\" type=\"button\" class=\"rounded-circle btn btn-sm btn-info\" title=\"Edit\">"+
						"<i class=\"fas fa-pencil-alt\"></i>"+
						"</a> "+
						" <button type=\"button\" class=\"rounded-circle btn btn-sm btn-danger\" data-id=\""+data.PermissionId+"\" title=\"Delete\"  onclick=\"deleteById(this,"+data.PermissionId+")\">";
					strbutton+=" <i class=\"fas fa-trash-alt\"></i> ";
					strbutton+=" </ button > ";

					cell0.innerHTML=check;
					cell1.innerHTML=data.PermissionId+strbutton;
					if(data.UserId==$('#UserId').val()) {
						cell2.innerHTML=$('#FullName').val();
					}
					if(data.Functions==$('#Functions').val()) {
						cell3.innerHTML=$('#Description').val();
					}
					cell4.innerHTML=data.FullAuthority;
					cell5.innerHTML=data.Addnew;
					cell6.innerHTML=data.Updates;
					cell7.innerHTML=data.ReadOnly;
					cell8.innerHTML=data.FullOfYourself;
					cell9.innerHTML=data.Permission1;
					cell10.innerHTML=data.Permission2;
					cell11.innerHTML=data.Permission3;
					cell12.innerHTML=data.Permission4;
					cell13.innerHTML=data.Permission5;
					cell14.innerHTML=data.Permission6;
					cell15.innerHTML=data.Permission7;
					cell16.innerHTML=data.Permission8;
					cell17.innerHTML=data.Permission9;
					cell18.innerHTML=data.Permission10;

					//cell19.innerHTML = strbutton;
				}

				$('#btnUpdate').click(function() {
					$(this).prop('disabled',true);
					saveUpdate();
				});

				function saveUpdate() {
					let data=getDataForm();
					if(data==false) {
						$('#btnUpdate').prop('disabled',false);
						return false;
					}
					if(data.PermissionIdHidden=="") {
						$('#btnUpdate').prop('disabled',false);
						showNoticeDanger(language.Message_HaveNotSelectedItemUpdate);
						return false;
					}
					var link=$('#linkPrefix').val()+'update';
					$.ajax({
						type: 'put',
						url: link,
						data: data,
						dataType: "json",
						success: function(response) {
							var success=response.success;
							var result=response.data;
							if((success=='false')||(success==false)) {
								showNoticeDanger(language.Message_UpdateError);
								return false;
							}
							else if((success!=true)&&(success!='true')) {
								showNoticeDanger(result.message);
								return false;
							}
							else {
								updateRow(result.data);
								//clearForm();
							}
						},
						failure: function(response) {
							showErrorMessageSave(response,language.Message_UpdateError);
						},
						error: function(response) {
							showErrorMessageSave(response,language.Message_UpdateError);
						}
					});
					$('#btnUpdate').prop('disabled',false);
				}

				function updateRow(data) {
					showNoticeSuccess(language.Message_UpdateSuccess);
					var row=$("#tableSys_Permission button[data-id='"+data.PermissionId+"']").parents("tr")[0];
					var tr="<tr>"+
						"<td class=\"text-center\">"+
						"<div class=\"custom-control custom-checkbox\">"+
						"<input class=\"custom-control-input\" type=\"checkbox\" name=\"chkListData\" id=\""+data.PermissionId+"\" value=\""+data.PermissionId+"\"> "+
						"<label for=\""+data.PermissionId+"\" class=\"custom-control-label\"></label> "+
						"</div>"+
						"</td>";
					tr+="<td class=\"text-center\">"+data.PermissionId;
					tr+="<br />"+
						" <a  onclick=\"getById('"+data.PermissionId+"')\" type=\"button\" class=\"rounded-circle btn btn-sm btn-info\" title=\"Edit\">"+
						" <i class=\"fas fa-pencil-alt\"></i>"+
						" </a>"+
						" <button type=\"button\" class=\"rounded-circle btn btn-sm btn-danger\" data-id=\""+data.PermissionId+"\" title=\"Delete\"  onclick=\"deleteById(this,'"+data.PermissionId+"')\">"+
						" <i class=\"fas fa-trash-alt\"></i> "+
						" </button> "+
						" </td>";


					if(data.UserId==$('#UserId').val()) {
						tr+="<td class=\"text-center\">"+$('#FullName').val()+"</td>";
					}
					if(data.Functions==$('#Functions').val()) {
						tr+="<td class=\"text-center\">"+$('#Description').val()+"</td>";
					}
					tr+="<td class=\"text-center\">"+data.FullAuthority+"</td>";
					tr+="<td class=\"text-center\">"+data.Addnew+"</td>";
					tr+="<td class=\"text-center\">"+data.Updates+"</td>";
					tr+="<td class=\"text-center\">"+data.ReadOnly+"</td>";
					tr+="<td class=\"text-center\">"+data.FullOfYourself+"</td>";
					tr+="<td class=\"text-center\">"+data.Permission1+"</td>";
					tr+="<td class=\"text-center\">"+data.Permission2+"</td>";
					tr+="<td class=\"text-center\">"+data.Permission3+"</td>";
					tr+="<td class=\"text-center\">"+data.Permission4+"</td>";
					tr+="<td class=\"text-center\">"+data.Permission5+"</td>";
					tr+="<td class=\"text-center\">"+data.Permission6+"</td>";
					tr+="<td class=\"text-center\">"+data.Permission7+"</td>";
					tr+="<td class=\"text-center\">"+data.Permission8+"</td>";
					tr+="<td class=\"text-center\">"+data.Permission9+"</td>";
					tr+="<td class=\"text-center\">"+data.Permission10+"</td>";
					// tr += "<td class=\"text-center\">" +
					// 	" <a  onclick=\"getById('" + data.PermissionId + "')\" type=\"button\" class=\"rounded-circle btn btn-sm btn-info\" title=\"Edit\">" +
					// 	" <i class=\"fas fa-pencil-alt\"></i>" +
					// 	" </a>" +
					// 	" <button type=\"button\" class=\"rounded-circle btn btn-sm btn-danger\" data-id=\"" + data.PermissionId + "\" title=\"Delete\"  onclick=\"deleteById(this,'" + data.PermissionId + "')\">" +
					// 	" <i class=\"fas fa-trash-alt\"></i> " +
					// 	" </button> " +
					// 	" </td>" +
					// 	" </tr>";
					tr+=" </tr>";
					$(row).after(tr);
					$(row).remove();
				}
				function deleteById(row,IdObject) {
					let message=language.Message_DoYouWantToDeleteById+' '+IdObject+'?';
					var answer=confirm(message)
					if(!answer) {return false;}
					let data={
						'PermissionId': IdObject
					};
					var link=$('#linkPrefix').val()+'deleteById';
					$.ajax({
						type: 'delete',
						url: link,
						data: data,
						dataType: "json",
						success: function(resultdata) {
							var success=resultdata.success;
							var message=resultdata.message;
							var notice={};
							if((success=='true')||(success==true)) {
								showNoticeSuccess(language.Message_DeleteSuccess);
								var i=row.parentNode.parentNode.rowIndex;
								document.getElementById("tableSys_Permission").deleteRow(i);
								return true;
							}
							else if(message.length>10) {
								showNoticeDanger(message);
								return false;
							}
							else {
								showNoticeDanger(language.Message_DeleteFail);
								return false;
							}
						},
						failure: function(response) {
							showNoticeDanger(language.Message_DeleteFail);
						},
						error: function(response) {
							showNoticeDanger(language.Message_DeleteFail);
						}
					});
				}

				$('#btnDelete').click(function() {
					$(this).prop('disabled',true);
					deleteList();
					$(this).prop('disabled',false);
				});
				function deleteList() {
					var arrayId=[];
					var listId=" ";
					$("input:checkbox[name=chkListData]:checked").each(function() {
						arrayId.push($(this).val());
						listId+=$(this).val()+' ';
					});
					let message=language.Message_DoYouWantToDeleteInTheList+' '+listId+'?';
					var answer=confirm(message)
					if(!answer) {return false;}
					let data={arrayId};
					var link=$('#linkPrefix').val()+'deleteList';
					$.ajax({
						type: 'delete',
						url: link,
						data: data,
						dataType: "json",
						success: function(resultdata) {
							var result=resultdata.result;
							var success=result.success;
							var message=result.message;
							if((success=='true')||(success==true)) {
								let deleteSuccess=result.deleteSuccess;
								let deleteError=result.deleteError;
								if(deleteSuccess.length>0) {
									let message=language.Message_DeleteSuccess;
									message+=" "+deleteSuccess.toString();
									if(deleteError.length>0) {
										message+=" \n"+language.Message_DeleteFail+" "+deleteError.toString();
									}
									showNoticeSuccess(message);
									deleteRows(arrayId,"tableSys_Permission");
									return true;
								}
								else if(deleteError.length>0) {
									let message=language.Message_DeleteFail+" "+deleteError.toString();
									showNoticeDanger(message);
								}
								else {
									showNoticeDanger(language.Message_DeleteFail);
								}
							}
							else if((success=='false')||(success==false)) {
								showNoticeDanger(language.Message_DeleteFail);
								return false;
							}
						},
						failure: function(response) {
							showNoticeDanger(language.Message_DeleteFail);
						},
						error: function(response) {
							showNoticeDanger(language.Message_DeleteFail);
						}
					});
				}

				$('#btnExport').click(function() {
					$(this).prop('disabled',true);
					exportData();
					$(this).prop('disabled',false);
				});

				function exportData() {
					let data={
						'UserId': $('#UserId').val(),
						'Functions': $('#Functions').val(),
					}
					var link=$('#linkPrefix').val()+'exportData';
					$.ajax({
						type: 'post',
						url: link,
						data: data,
						dataType: "json",
						success: function(resultdata) {
							$('#btnExport').prop('disabled',false);
							let result=resultdata.result;
							showNoticeSuccess(language.Message_CompletedGetData);
							ExportToExcel(result);
						},
						failure: function(response) {
							$('#btnExport').prop('disabled',false);
							showNoticeDanger('Export Error');
						},
						error: function(response) {
							$('#btnExport').prop('disabled',false);
							showNoticeDanger('Export Error');
						}
					});
					$('#btnExport').prop('disabled',false);
				}

				function ExportToExcel(datas) {
					let itemCount=datas.length;
					if(itemCount>1000) {
						showNoticeDanger(language.Message_WarningWhenExportingDataTooMuch);
					}
					if(itemCount<1) {
						showNoticeDanger(language.Message_NotFoundData);
					}
					var strTable='<style type="text/css">';
					strTable+=' .Border { ';
					strTable+='         color: windowtext; ';
					strTable+='         font-size: 11.0pt; ';
					strTable+='         word-break:break-all;';
					strTable+='         font-style: normal; ';
					strTable+='         text-decoration: none; ';
					strTable+='         font-family: "Times New Roman", serif; ';
					strTable+='         text-align: left; ';
					strTable+='         vertical-align: bottom;';
					strTable+='         border-left: .5pt solid windowtext; ';
					strTable+='         border-right: .5pt solid windowtext; ';
					strTable+='         border-top: .5pt solid windowtext; ';
					strTable+='         border-bottom: .5pt solid windowtext; ';
					strTable+='         padding-left: 1px; ';
					strTable+='         padding-right: 1px; ';
					strTable+='         padding-top: 1px; ';
					strTable+='     } ';

					strTable+=' .BorderHeader { ';
					strTable+='        color: white; ';
					strTable+='         background-color:#0026ff; ';
					strTable+='        font-size: 11.0pt; ';
					strTable+='        text-align: center; ';
					strTable+='        font-style: normal; ';
					strTable+='        text-decoration: none; ';
					strTable+='        font-family: "Times New Roman", serif; ';
					strTable+='        vertical-align: bottom;';
					strTable+='        border-left: .5pt solid windowtext; ';
					strTable+='        border-right: .5pt solid windowtext; ';
					strTable+='        border-top: .5pt solid windowtext; ';
					strTable+='        border-bottom: .5pt solid windowtext; ';
					strTable+='        padding-left: 1px; ';
					strTable+='        padding-right: 1px; ';
					strTable+='        padding-top: 1px; ';
					strTable+='     } ';
					strTable+='  </style> ';
					strTable+=' <table id="testTable"  border="1" frame="hsides" rules="groups" summary="Code page support in different versions of MS Windows."> ';
					strTable+='<tr class="BorderHeader" style="background - color:#0026ff; color:#fff"> ';
					strTable+='<th class="BorderHeader" >Order</th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> PermissionId </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> User </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> Functions </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> FullAuthority </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> Addnew </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> Updates </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> ReadOnly </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> Full Of Yourself </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> Permission 1 </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> Permission 2 </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> Permission 3 </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> Permission 4 </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> Permission 5 </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> Permission 6 </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> Permission 7 </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> Permission 8 </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> Permission 9 </th> ';
					strTable+='<th  class="BorderHeader" style="width: 100px; white - space:nowrap"> Permission 10 </th> ';
					strTable+='</tr> ';
					var n=0;
					var currentRow=4;
					for(var i=0;i<itemCount;i++) {
						var vTemp=datas[i];
						currentRow+=1;
						n+=1;
						strTable+='<tr >';
						strTable+='<th class="Border" > '+n+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.PermissionId+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.FullName+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.Functions+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.FullAuthority+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.Addnew+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.Updates+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.ReadOnly+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.FullOfYourself+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.Permission1+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.Permission2+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.Permission3+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.Permission4+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.Permission5+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.Permission6+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.Permission7+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.Permission8+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.Permission9+' </th> ';
						strTable+='<th  class="Border" > '+vTemp.Permission10+' </th> ';
						strTable+='</tr>';
					}
					strTable+=' </table> ';
					ExportHtmlToExcel(strTable,'Sys_Permission');
					showNoticeSuccess(language.Message_ExportSuccess);
				}

			</script>